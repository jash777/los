<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lending Backend – System Diagram</title>
  <style>
    :root{
      --bg:#0f172a;           /* slate-900 */
      --panel:#111827;        /* gray-900 */
      --ink:#e5e7eb;          /* gray-200 */
      --muted:#9ca3af;        /* gray-400 */
      --brand:#10b981;        /* emerald-500 (Swagger-ish accent) */
      --brand-2:#34d399;      /* emerald-400 */
      --chip:#1f2937;         /* gray-800 */
      --line:#1f2937;         /* gray-800 */
      --card:#0b1222;         /* deep panel */
      --warning:#f59e0b;
      --ok:#22c55e;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.6 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji","Segoe UI Emoji"}
    a{color:var(--brand)}
    .topbar{position:sticky;top:0;z-index:50;display:flex;align-items:center;gap:.75rem;padding:.9rem 1.2rem;background:linear-gradient(90deg,#0b1222, #0f172a);border-bottom:1px solid #111827}
    .logo{width:10px;height:10px;border-radius:3px;background:var(--brand);box-shadow:0 0 0 6px rgba(16,185,129,.15)}
    .title{font-weight:700;letter-spacing:.2px}
    .subtitle{color:var(--muted);font-size:.9rem}

    .wrap{display:grid;grid-template-columns:260px 1fr;min-height:calc(100vh - 56px)}
    .nav{background:var(--panel);border-right:1px solid #0b1222;padding:1rem;position:sticky;top:56px;height:calc(100vh - 56px);overflow:auto}
    .nav h3{margin:.5rem 0 .25rem;font-size:.8rem;color:var(--brand-2);text-transform:uppercase;letter-spacing:.08em}
    .nav a{display:block;padding:.5rem .6rem;border-radius:8px;color:var(--ink);text-decoration:none;opacity:.9}
    .nav a:hover{background:#0b1222}

    .main{padding:1.2rem 1.4rem}

    .panel{background:var(--panel);border:1px solid #0b1222;border-radius:14px;padding:1rem;margin:0 0 1rem}
    .panel h2{margin:.2rem 0 1rem;font-size:1.05rem}
    .grid{display:grid;gap:1rem}

    .kpis{display:grid;grid-template-columns:repeat(2,1fr);gap:.8rem}
    .card{background:var(--card);border:1px solid #0a0f1e;border-radius:14px;padding:1rem}
    .card h4{margin:.2rem 0 .5rem;font-size:.95rem}
    .chip{display:inline-flex;align-items:center;gap:.4rem;background:var(--chip);border:1px solid #0b1222;border-radius:999px;padding:.15rem .55rem;font-size:.8rem;color:var(--muted)}
    .dot{width:7px;height:7px;border-radius:50%;background:var(--brand)}

    /* Flow diagram */
    .flow{overflow:auto;border-radius:12px;border:1px dashed #223;position:relative;background:radial-gradient(1200px 300px at 50% -10%, #0c1324 0%, #0f172a 60%)}
    svg{display:block;width:1200px;height:360px}

    .node{cursor:pointer}
    .node rect{fill:#0b1222;stroke:#1f2a44;stroke-width:1.2}
    .node:hover rect{stroke:var(--brand-2)}
    .node text{font-size:12px;fill:#e5e7eb}
    .badge{fill:var(--brand);}

    .legend{display:flex;gap:.6rem;flex-wrap:wrap;margin-top:.6rem}
    .legend .chip .sw{width:10px;height:10px;border-radius:2px;background:var(--brand)}

    /* Details drawer */
    .details{display:none;margin-top:.8rem}
    .details.active{display:block}
    ul{margin:.25rem 0 .25rem 1.1rem}
    li{margin:.15rem 0}

    /* Stage list */
    .stages{display:grid;grid-template-columns:repeat(2,1fr);gap:.8rem}
    .stage{border:1px solid #0b1222;background:#0b1222;border-radius:12px;padding:.7rem}
    .stage h5{margin:.1rem 0 .4rem;font-size:.9rem}
    .num{display:inline-block;min-width:22px;height:22px;border-radius:6px;background:var(--brand);color:#052e26;text-align:center;line-height:22px;font-weight:700;margin-right:.45rem}

    @media (max-width: 960px){
      .wrap{grid-template-columns:1fr}
      .nav{position:static;height:auto}
      svg{width:1000px;height:360px}
      .stages{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="logo" aria-hidden="true"></div>
    <div>
      <div class="title">Lending Backend – System Diagram</div>
      <div class="subtitle">Swagger‑style documentation layout for developer understanding</div>
    </div>
  </header>

  <div class="wrap">
    <aside class="nav">
      <h3>Sections</h3>
      <a href="#auth">Auth & Roles</a>
      <a href="#flow">System Flow</a>
      <a href="#stages">Stages & Details</a>
      <a href="#manual">Manual Phase</a>
    </aside>

    <main class="main">

      <!-- Auth -->
      <section id="auth" class="panel">
        <h2>Auth & Roles</h2>
        <div class="kpis">
          <div class="card">
            <h4>Admins</h4>
            <div class="legend">
              <span class="chip"><span class="dot"></span>Full access</span>
              <span class="chip">Policy & config</span>
              <span class="chip">Audit</span>
            </div>
            <ul>
              <li>Create/update lending policies and rule engine configs</li>
              <li>Manage users, roles, and access scopes</li>
              <li>Override decisions, unlock cases, export audit trails</li>
            </ul>
          </div>
          <div class="card">
            <h4>Employees</h4>
            <div class="legend">
              <span class="chip"><span class="dot" style="background:var(--warning)"></span>Ops scope</span>
              <span class="chip">Assignments</span>
              <span class="chip">Manual review</span>
            </div>
            <ul>
              <li>Handle manual + automated loan application steps</li>
              <li>Receive assignments via skill/priority routing</li>
              <li>Perform verifications, record decisions and notes</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Flow Diagram -->
      <section id="flow" class="panel">
        <h2>End‑to‑End Flow</h2>
        <div class="flow" role="img" aria-label="Loan flow diagram">
          <svg viewBox="0 0 1200 360" xmlns="http://www.w3.org/2000/svg">
            <!-- connectors -->
            <defs>
              <marker id="arrow" markerWidth="8" markerHeight="8" refX="7" refY="3.5" orient="auto">
                <polygon points="0 0, 7 3.5, 0 7" fill="var(--brand)" />
              </marker>
            </defs>

            <!-- row 1 nodes -->
            <g class="node" data-target="#d1">
              <rect x="40" y="48" rx="10" ry="10" width="220" height="70"/>
              <rect x="40" y="48" width="6" height="70" class="badge"/>
              <text x="60" y="70">1. Pre‑qualification</text>
              <text x="60" y="92" fill="var(--muted)">Eligibility, credit pre‑check</text>
            </g>

            <g class="node" data-target="#d2">
              <rect x="300" y="48" rx="10" ry="10" width="220" height="70"/>
              <rect x="300" y="48" width="6" height="70" class="badge"/>
              <text x="320" y="70">2. Loan application</text>
              <text x="320" y="92" fill="var(--muted)">KYC/AML, risk intake</text>
            </g>

            <g class="node" data-target="#d3">
              <rect x="560" y="48" rx="10" ry="10" width="220" height="70"/>
              <rect x="560" y="48" width="6" height="70" class="badge"/>
              <text x="580" y="70">3. Application processing</text>
              <text x="580" y="92" fill="var(--muted)">Bureau, DTI, statements</text>
            </g>

            <g class="node" data-target="#d4">
              <rect x="820" y="48" rx="10" ry="10" width="220" height="70"/>
              <rect x="820" y="48" width="6" height="70" class="badge"/>
              <text x="840" y="70">4. Underwriting</text>
              <text x="840" y="92" fill="var(--muted)">Rules, scoring, decisions</text>
            </g>

            <!-- row 2 nodes -->
            <g class="node" data-target="#d5">
              <rect x="160" y="206" rx="10" ry="10" width="220" height="70"/>
              <rect x="160" y="206" width="6" height="70" class="badge"/>
              <text x="180" y="228">5. Credit decision</text>
              <text x="180" y="250" fill="var(--muted)">Approve / Reject / Review</text>
            </g>

            <g class="node" data-target="#d6">
              <rect x="420" y="206" rx="10" ry="10" width="220" height="70"/>
              <rect x="420" y="206" width="6" height="70" class="badge"/>
              <text x="440" y="228">6. Quality check</text>
              <text x="440" y="250" fill="var(--muted)">Compliance & integrity</text>
            </g>

            <g class="node" data-target="#d7">
              <rect x="680" y="206" rx="10" ry="10" width="220" height="70"/>
              <rect x="680" y="206" width="6" height="70" class="badge"/>
              <text x="700" y="228">7. Loan funding</text>
              <text x="700" y="250" fill="var(--muted)">Disbursement</text>
            </g>

            <!-- arrows row1 -->
            <line x1="260" y1="83" x2="300" y2="83" stroke="var(--brand)" stroke-width="2" marker-end="url(#arrow)"/>
            <line x1="520" y1="83" x2="560" y2="83" stroke="var(--brand)" stroke-width="2" marker-end="url(#arrow)"/>
            <line x1="780" y1="83" x2="820" y2="83" stroke="var(--brand)" stroke-width="2" marker-end="url(#arrow)"/>

            <!-- drop to row2 -->
            <path d="M 930 118 C 930 150, 930 170, 820 206" fill="none" stroke="var(--brand)" stroke-width="2" marker-end="url(#arrow)"/>
            <!-- row2 arrows -->
            <line x1="380" y1="241" x2="420" y2="241" stroke="var(--brand)" stroke-width="2" marker-end="url(#arrow)"/>
            <line x1="640" y1="241" x2="680" y2="241" stroke="var(--brand)" stroke-width="2" marker-end="url(#arrow)"/>
          </svg>
        </div>
        <div class="legend">
          <span class="chip"><span class="sw"></span> Stage</span>
          <span class="chip">Click a stage to expand details</span>
        </div>

        <!-- Click‑revealed details -->
        <div id="d1" class="details">
          <h4>Pre‑qualification</h4>
          <ul>
            <li>Basic eligibility checks</li>
            <li>Credit score validation</li>
            <li>Income verification</li>
            <li>Document completeness check</li>
          </ul>
        </div>
        <div id="d2" class="details">
          <h4>Loan application</h4>
          <ul>
            <li>Detailed application processing</li>
            <li>KYC/AML verification</li>
            <li>Risk assessment</li>
            <li>Fraud detection</li>
          </ul>
        </div>
        <div id="d3" class="details">
          <h4>Application processing</h4>
          <ul>
            <li>Credit bureau checks</li>
            <li>Employment verification</li>
            <li>Bank statement analysis</li>
            <li>Debt‑to‑income ratio calculation</li>
          </ul>
        </div>
        <div id="d4" class="details">
          <h4>Underwriting</h4>
          <ul>
            <li>Automated decision engine</li>
            <li>Policy rule validation</li>
            <li>Risk scoring</li>
            <li>Approval/rejection logic</li>
          </ul>
        </div>
        <div id="d5" class="details">
          <h4>Credit decision</h4>
          <ul>
            <li>Approve / Reject / Send to manual review</li>
            <li>Decision reasons stored for audit</li>
          </ul>
        </div>
        <div id="d6" class="details">
          <h4>Quality check</h4>
          <ul>
            <li>Final validation</li>
            <li>Compliance verification</li>
            <li>Data integrity checks</li>
            <li>Transition decision to manual phase</li>
          </ul>
        </div>
        <div id="d7" class="details">
          <h4>Loan funding</h4>
          <ul>
            <li>Manual review and approval</li>
            <li>Document verification</li>
            <li>Final decision making</li>
            <li>Disbursement processing</li>
          </ul>
        </div>
      </section>

      <!-- Stage list (readable, copy‑friendly) -->
      <section id="stages" class="panel">
        <h2>Stages & Key Checks</h2>
        <div class="stages">
          <div class="stage"><h5><span class="num">1</span>Pre‑qualification</h5>
            <ul>
              <li>Basic eligibility checks; credit score validation</li>
              <li>Income verification; document completeness check</li>
            </ul>
          </div>
          <div class="stage"><h5><span class="num">2</span>Loan application</h5>
            <ul>
              <li>Detailed application intake and validation</li>
              <li>KYC/AML verification, risk assessment, fraud detection</li>
            </ul>
          </div>
          <div class="stage"><h5><span class="num">3</span>Application processing</h5>
            <ul>
              <li>Credit bureau checks; employment verification</li>
              <li>Bank statement analysis; DTI calculation</li>
            </ul>
          </div>
          <div class="stage"><h5><span class="num">4</span>Underwriting</h5>
            <ul>
              <li>Automated decision engine; policy rules</li>
              <li>Risk scoring; approval/rejection logic</li>
            </ul>
          </div>
          <div class="stage"><h5><span class="num">5</span>Credit decision</h5>
            <ul>
              <li>Approve / Reject / Review with reasons</li>
            </ul>
          </div>
          <div class="stage"><h5><span class="num">6</span>Quality check</h5>
            <ul>
              <li>Final validation; compliance; data integrity</li>
              <li>Transition decision to manual phase</li>
            </ul>
          </div>
          <div class="stage"><h5><span class="num">7</span>Loan funding</h5>
            <ul>
              <li>Manual review & approval; docs verification</li>
              <li>Final decision; disbursement processing</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Manual Phase -->
      <section id="manual" class="panel">
        <h2>Manual Phase Flow</h2>
        <div class="grid" style="grid-template-columns:repeat(2,1fr)">
          <div class="card">
            <h4>Employee Assignment</h4>
            <ul>
              <li>Load balancing algorithm</li>
              <li>Skill‑based routing</li>
              <li>Priority‑based assignment</li>
              <li>Escalation rules</li>
            </ul>
          </div>
          <div class="card">
            <h4>Loan Funding Stage</h4>
            <ul>
              <li>Manual review and approval</li>
              <li>Document verification</li>
              <li>Final decision making</li>
              <li>Disbursement processing</li>
            </ul>
          </div>
        </div>
      </section>

    </main>
  </div>

  <script>
    // Click to toggle stage details
    document.querySelectorAll('.node').forEach(n=>{
      n.addEventListener('click',()=>{
        const id = n.getAttribute('data-target');
        document.querySelectorAll('.details').forEach(d=>d.classList.remove('active'));
        const target = document.querySelector(id);
        if(target) target.classList.add('active');
        target?.scrollIntoView({behavior:'smooth',block:'nearest'});
      })
    })
  </script>
</body>
</html>
